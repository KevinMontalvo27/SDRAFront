<div class="container mx-auto mt-4">
  <div class="flex items-center justify-center">
    <h1 class="text-3xl font-bold">Gestión de contenidos</h1>
  </div>
</div>

<!-- Modal Unidad -->
<div *ngIf="showUnitModal && editingUnit" class="modal modal-open">
  <div class="modal-box">
    <h3 class="font-bold text-lg mb-4">Editar Unidad</h3>
    <form #unitForm="ngForm" (ngSubmit)="saveUnit(unitForm.value)">
      <div class="form-control">
        <label class="label"><span class="label-text">Título</span></label>
        <input
          type="text"
          name="nombre"
          [(ngModel)]="editingUnit!.nombre"
          class="input input-bordered"
          required
        />
      </div>
      <div class="form-control mt-3">
        <label class="label"><span class="label-text">Descripción</span></label>
        <textarea
          name="descripcion"
          [(ngModel)]="editingUnit!.descripcion"
          class="textarea textarea-bordered"
          required
        ></textarea>
      </div>
      <div class="form-control mt-3">
        <label class="label"><span class="label-text">Orden</span></label>
        <input
          type="number"
          name="numero_unidad"
          [(ngModel)]="editingUnit!.numero_unidad"
          class="input input-bordered"
          min="1"
          required
        />
      </div>
      <div class="modal-action">
        <button type="button" class="btn" (click)="showUnitModal = false">
          Cancelar
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="!unitForm.valid"
        >
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>
<div class="p-4">
  <h3 class="font-bold text-lg mb-4">Nueva Unidad</h3>
  <form #unitForm="ngForm" (ngSubmit)="saveUnit(unitForm.value)">
    <div class="form-control">
      <label class="label"><span class="label-text">Título</span></label>
      <input
        type="text"
        name="nombre"
        [(ngModel)]="nombreNuevaUnidad"
        class="input input-bordered"
        required
      />
    </div>
    <div class="form-control mt-3">
      <label class="label"><span class="label-text">Descripción</span></label>
      <textarea
        name="descripcion"
        [(ngModel)]="descripcionNuevaUnidad"
        class="textarea textarea-bordered"
        required
      ></textarea>
    </div>
    <div class="form-control mt-3">
      <label class="label"><span class="label-text">Orden</span></label>
      <input
        type="number"
        name="numero_unidad"
        [(ngModel)]="numeroNuevaUnidad"
        class="input input-bordered"
        min="1"
        required
      />
    </div>
    <div class="modal-action">
      <button type="button" class="btn" (click)="showUnitModal = false">
        Cancelar
      </button>
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="!unitForm.valid"
      >
        Guardar
      </button>
    </div>
  </form>
</div>

<!-- Modal Tema (similar estructura) -->
<div *ngIf="showTopicModal" class="modal modal-open">
  <div class="modal-box">
    <h3 class="font-bold text-lg mb-4">
      {{ editingTopic ? "Editar" : "Nuevo" }} Tema
    </h3>
    <form #topicForm="ngForm" (ngSubmit)="saveTopic(topicForm.value)">
      <div class="form-control">
        <label class="label"><span class="label-text">Título</span></label>
        <input
          type="text"
          name="nombre"
          [ngModel]="editingTopic?.nombre"
          class="input input-bordered"
          required
        />
      </div>
      <div class="form-control mt-3">
        <label class="label"><span class="label-text">Descripción</span></label>
        <textarea
          name="description"
          [ngModel]="editingTopic?.descripcion"
          class="textarea textarea-bordered"
          required
        ></textarea>
      </div>
      <div class="form-control mt-3">
        <label class="label"><span class="label-text">Orden</span></label>
        <input
          type="number"
          name="order"
          [ngModel]="editingTopic?.numero_tema"
          class="input input-bordered"
          min="1"
          required
        />
      </div>
      <div class="modal-action">
        <button type="button" class="btn" (click)="showTopicModal = false">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Objeto de Aprendizaje -->
<div *ngIf="showObjectModal" class="modal modal-open">
  <div class="modal-box max-w-2xl">
    <h3 class="font-bold text-lg mb-4">
      {{ editingObject ? "Editar" : "Nuevo" }} Objeto
    </h3>
    <form #objForm="ngForm" (ngSubmit)="saveObject(objForm, fileInput)">
      <input type="hidden" name="id_tema" [value]="1" ngModel />

      <div class="form-control">
        <label class="label"><span class="label-text">Título</span></label>
        <input
          type="text"
          name="nombre"
          ngModel
          class="input input-bordered"
          required
        />
      </div>

      <div class="form-control mt-3">
        <label class="label"><span class="label-text">Descripción</span></label>
        <textarea
          name="descripcion"
          ngModel
          class="textarea textarea-bordered"
          required
        ></textarea>
      </div>

      <div class="form-control mt-3">
        <label class="label"><span class="label-text">Tipo</span></label>
        <!-- mantener referencia #typeSelect si la necesitas; el name y ngModel permiten leerlo desde form.value -->
        <select
          name="id_type"
          class="select select-bordered"
          required
          #typeSelect
          ngModel
        >
          <option value="1">Texto Plano</option>
          <option value="2">PDF</option>
          <option value="3">Video</option>
          <option value="4">Imagen</option>
          <option value="5">Audio</option>
        </select>
      </div>

      <!-- input de archivo con referencia template -->
      <div *ngIf="typeSelect.value !== '1'" class="form-control mt-3">
        <label class="label"><span class="label-text">Archivo</span></label>
        <input
          type="file"
          (change)="onFileSelected($event)"
          name="file"
          class="file-input file-input-bordered"
          #fileInput
        />
      </div>
      <div class="modal-action">
        <button type="button" class="btn" (click)="showObjectModal = false">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
    </form>
  </div>
</div>
